# Лабораторная работа №3: Работа с разреженными матрицами

**Цель работы:** реализация алгоритмов обработки разреженных матриц, сравнение этих алгоритмов сл стандартными алгоритмами обработки матриц при различном размере матриц и степени их разреженности.

## Условие задачи (Вариант 5)

 Разреженная (содержащая много нулей) матрица хранится в форме 3-х объектов:
 
 * вектор A содержит значения ненулевых элементов;
 * вектор JA содержит номера столбцов для элементов вектора A;
 * связный список IA, в элементе Nk которого находится номер компонент в A и JA, с которых начинается описание строки Nk матрицы A.
 
 1. Смоделировать операцию умножения вектора-строки и матрицы, хранящихся в этой форме, с получением результата в той же форме.
 2. Произвести операцию умножения, применяя стандартный алгоритм работы с матрицами.
 3. Сравнить время выполнения операций и объем памяти при использовании этих 2-х алгоритмов при различном проценте заполнения матриц.

**Входные данные:** матрица и вектор-строка заданного размера 

**Выходные данные:** вектор-строка - результат произведения вектора и матрицы

## Используемые структуры

```cpp
typedef struct my_list my_list;     // sizeof = 20 B
typedef struct Matrix Matrix;       // sizeof = (8 * count + 20 * n) B
typedef struct Vector Vector;       // sizeof = (8 * count) B
```

### Двусвязный список

```cpp
struct my_list
{
    int data;                       // элемент списка
    my_list *next;                  // следующий элемент
    my_list *prev;                  // предыдущий элемент
};
```

### Матрица

```cpp
struct Matrix
{
    int n;                          // количество строк
    int m;                          // количество столбцов
    vector<int> values;             // значения ненулевых элементов
    vector<int> number_of_columns;  // номера столбцов
    my_list *first_elements;        // номера первых элементов строк
};
```

### Вектор-строка

```cpp
struct Vector
{
    int n;                          // Количество элементов
    vector<int> values;             // Значения вектора
    vector<int> columns;            // Номера столбцов
};
```

## Тесты

### Негативные тесты

1. **Некорректные данные**

	```
	[1] - Ввести данные
	[2] - Использовать заранее подготовленные данные
	asd
	Некорректные данные!
	```
2. **Некорректная размерность**

	```
	[1] - Ввести данные
	[2] - Использовать заранее подготовленные данные
	1
	Количество строк: -1
	Некорректные данные!
	```
	
3. **Некорректные координаты**

	```
	[1] - Ввести данные
	[2] - Использовать заранее подготовленные данные
	1
	Количество строк: 5
	Количество столбцов: 5
	Количество ненулевых элементов: 5
	Как ввести элементы?
	[1] - Вручную
	[2] - Автозаполнение
	1
	Через пробел номер столбца, строки и значение: 6 1 2
	Некорректные данные!
	```

3. **Размерность вектора и матрицы не совпадает**

	```
	[1] - Ввести данные
	[2] - Использовать заранее подготовленные данные
	1
	Количество строк: 5
	Количество столбцов: 5
	Количество ненулевых элементов: 3
	Как ввести элементы?
	[1] - Вручную
	[2] - Автозаполнение
	2
	Матрица:
	Размерность: 5 5
	Значения: 1 3 2
	Столбцы: 0 1 2
	Номера первых элементов: 0 5 10 3 3
	
	Количество элементов вектора: 3
	Количество ненулевых элементов: 2
	Как ввести элементы?
	[1] - Вручную
	[2] - Автозаполнение
	2
	Вектор:
	Размерность: 3
	Значения: 2 1
	Позиции:  0 2
	
	Некорректные данные!
	```
	
5. **Несуществующий файл**

	```
	[1] - Ввести данные
	[2] - Использовать заранее подготовленные данные
	2
	Файлы:
	1.in	2.in	3.in	4.in
	5.in
	Некорректные данные!
	```
	
### Позитивные тесты

1. **Ввод с подготовленного файла**

	```
	[1] - Ввести данные
	[2] - Использовать заранее подготовленные данные
	2
	Файлы:
	1.in	2.in	3.in	4.in
	1.in
	Матрица:
	Размерность: 3 3
	Значения: 1 2 3 4
	Столбцы: 0 0 2 1
	Номера первых элементов: 0 1 3
	
	Вектор:
	Размерность: 3
	Значения: 1 3
	Позиции:  0 2
	
	Матрица:
	1 0 0
	2 0 3
	0 4 0
	
	Вектор: 1 0 3
	
	Ответ:
	Вектор:
	Размерность: 3
	Значения: 1 12
	Позиции:  0 1
	
	Ответ:
	Вектор: 1 12 0
	
	Хранение разряженной: 14 тиков
	Обычная матрица: 10 тиков
	```
	
2. **Ввод вручную**

	```
	[1] - Ввести данные
	[2] - Использовать заранее подготовленные данные
	1
	Количество строк: 5
	Количество столбцов: 5
	Количество ненулевых элементов: 3
	Как ввести элементы?
	[1] - Вручную
	[2] - Автозаполнение
	1
	Через пробел номер столбца, строки и значение: 0 0 1
	Через пробел номер столбца, строки и значение: 2 2 3
	Через пробел номер столбца, строки и значение: 4 2 8
	Матрица:
	Размерность: 5 5
	Значения: 1 3 8
	Столбцы: 0 2 2
	Номера первых элементов: 0 1 1 2 2
	
	Количество элементов вектора: 5
	Количество ненулевых элементов: 2
	Как ввести элементы?
	[1] - Вручную
	[2] - Автозаполнение
	1
	Через пробел номер столбца и значение: 0 6
	Через пробел номер столбца и значение: 2 1
	Вектор:
	Размерность: 5
	Значения: 6 1
	Позиции:  0 2
	
	Матрица:
	1 0 0 0 0
	0 0 0 0 0
	0 0 3 0 0
	0 0 0 0 0
	0 0 8 0 0
	
	Вектор: 6 0 1 0 0
	
	Ответ:
	Вектор:
	Размерность: 5
	Значения: 6 3
	Позиции:  0 2
	
	Ответ:
	Вектор: 6 0 3 0 0
	
	Хранение разряженной: 15 тиков
	Обычная матрица: 24 тиков
	```
	
3. **Генерация случайной матрицы**

	```
	[1] - Ввести данные
	[2] - Использовать заранее подготовленные данные
	1
	Количество строк: 3
	Количество столбцов: 3
	Количество ненулевых элементов: 5
	Как ввести элементы?
	[1] - Вручную
	[2] - Автозаполнение
	2
	Матрица:
	Размерность: 3 3
	Значения: 2 5 1 3 4
	Столбцы: 0 1 2 0 1
	Номера первых элементов: 0 3 6
	
	Количество элементов вектора: 3
	Количество ненулевых элементов: 2
	Как ввести элементы?
	[1] - Вручную
	[2] - Автозаполнение
	2
	Вектор:
	Размерность: 3
	Значения: 2 1
	Позиции:  0 1
	
	Матрица:
	2 5 1
	3 4 32767
	0 0 0
	
	Вектор: 2 1 0
	
	Ответ:
	Вектор:
	Размерность: 3
	Значения: 7 14 32769
	Позиции:  0 1 2
	
	Ответ:
	Вектор: 7 14 32769
	
	Хранение разряженной: 11 тиков
	Обычная матрица: 7 тиков
	```

## Сравнение 

### Время 

|Количество элементов|Процент заполнения|Обычная (тиков)|В разреженном виде (тиков)|Эффективность|
|----|----|----|----|----|
|100|5%|6|9|-50%|
|100|20%|6|9|-50%|
|100|50%|6|9|-50%|
|100|100%|6|11|-83%|
|10000|5%|145|2873|-1881%|
|10000|20%|145|2888|-1891%|
|10000|50%|145|2925|-1917%|
|10000|100%|145|3329|-2195%|

### Память

|Количество элементов|Процент заполнения|Обычная (байт)|В разреженном виде (байт)|Эффективность|
|----|----|----|----|----|
|100|5%|400|240|40%|
|100|20%|400|360|10%|
|100|50%|400|600|-50%|
|100|100%|400|1000|-150%|
|10000|5%|40000|6000|85%|
|10000|20%|40000|18000|55%|
|10000|50%|40000|42000|-5%|
|10000|100%|40000|82000|-105%|

## Контрольные вопросы

1. **Что такое разреженная матрица, какие схемы хранения таких матриц Вы знаете?** <br> Разреженная матрица - это матрица, содержащая большое количество нулевых элементов. Такие матрицы можно хранить как обычную и в виде трех массивов, хранящие только ненудевые элементы и их позицию.

2. **Каким образом и сколько памяти выделяется под хранение разреженной и обычной матрицы?** <br> Для обычной матрицы память выделяется под каждый элемент. Для каждого элемента выделяется только одна ячейка памяти. При хранении разреженной матрицы память выделяется только для ненулевых элементов. Для каждого элемента необходимо хранить значение и позицию.

3. **Каков принцип обработки разреженной матрицы?** <br> Обрабатываются только ненулевые элементы, нулевые не учитываются, так как не влияют на результат.

4. **В каком случае для матриц эффективнее применять стандартные
алгоритмы обработки матриц? От чего это зависит?** <br> В случае высокого процента заполнения ненулевыми элементами эффективнее использовать обычную матрицу.

## Вывод

При малом количестве ненулевых элементов в матрице эффективней по памяти и времени хранить ее в разреженном виде, но при увеличении этого количествва матрица в обычном виде становится эффективней.